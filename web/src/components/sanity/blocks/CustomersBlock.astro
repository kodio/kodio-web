---
import type { Props as PortableTextProps } from 'astro-portabletext/types';
import Image from '@/components/sanity/Image.astro';

import type { Customers } from '@/lib/sanity';

export type Props = PortableTextProps<Customers>;

const { node } = Astro.props;
const images = node.images?.length;
---

<div class="customers">
  <div class="customers-container">
    {
      node.images &&
        node.images.map(
          (image) =>
            image.image && (
              <div class="customer">
                <Image image={image.image} />
              </div>
            ),
        )
    }
    {
      node.images &&
        node.images.map(
          (image) =>
            image.image && (
              <div class="customer">
                <Image image={image.image} />
              </div>
            ),
        )
    }
  </div>
</div>

<style lang="scss" define:vars={{ images }}>
  $animationSpeed: 20s;

  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(calc(-190px * var(--images)));
    }
  }

  .customers {
    height: 100px;
    margin: auto;
    overflow: hidden;
    width: 100%;

    .customers-container {
      animation: scroll $animationSpeed linear infinite;
      display: flex;
      width: calc(190px * var(--images) * 2);
    }

    .customer {
      height: 100px;
      width: 250px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-right: 35px;
    }
  }
</style>
